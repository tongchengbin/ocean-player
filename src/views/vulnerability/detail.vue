<template>
  <div class="container">
    <div style="margin-top: 30px"></div>
    <h1 style="color: #ffffff">{{ data.name }}</h1>
    <div id="vditor"></div>
    <div id="my-markdown">
      <div class="markdown-body" v-html="renderedMarkdown"></div>
    </div>
  </div>
</template>

<script>
import request from "@/utils/request";
import 'mavon-editor/dist/css/index.css'
import 'mavon-editor/dist/highlightjs/styles/github-dark.min.css'
import MarkdownIt from 'markdown-it';
import hljs from 'highlight.js' // https://highlightjs.org
export default {
  name: "detail",
  components: {},
  data() {
    return {
      markdownText: '# Hello, Markdown!',
      renderedMarkdown: '',
      data: {
        description: '',
        name: ''
      }
    }
  },
  created() {
    let {query} = this.$route
    this.getDetail(query.id)
  },

  methods: {
    getDetail(id) {
      request.get(`/api/vulnerability/${id}`).then(res => {
        const md = new MarkdownIt({
          html: true,
          linkify: false,
          typographer: true,
          highlight: function (str, lang) {
            if (lang && hljs.getLanguage(lang)) {
              try {
                return '<pre><code class="hljs">' +
                    hljs.highlight(str, {language: lang, ignoreIllegals: true}).value +
                    '</code></pre>';
              } catch (__) {
              }
            }
          }
        }).use(require('markdown-it-highlightjs'));
        this.data = res.data
        this.renderedMarkdown = md.render(this.data.description);
      })

    }

  }
}
</script>

<style lang="less">
.markdown-body {
  line-height: 1.5;
  a{
    color: #0969da;
  }
  p{
    margin-bottom: 16px;
  }
  * {
    text-align: left;
    color: #ffffff;
  }
  h1,h2,h3,h4,h5,h6{
    margin-top: 24px;
    margin-bottom: 16px;
    line-height: 1.25
  }
  h2 {
    padding-bottom: .3em;
    font-size: 1.5em;
    border-bottom: 1px solid , var(#d0d7deb3,600);
    text-align: left;
  }
}
</style>